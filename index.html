<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BWC Exchange Submission</title>
  <style>
    body { font-family: Arial,sans-serif; background: linear-gradient(to right,#eef2f3,#d9e2ec); margin:0; padding:0; }
    .container { max-width:380px; margin:100px auto; background:#fff; padding:25px; border-radius:10px; box-shadow:0 8px 20px rgba(0,0,0,0.15);}
    .title { text-align:center; font-size:22px; margin-bottom:20px; color:#333; font-weight:bold;}
    label { display:block; margin-bottom:6px; font-weight:bold; color:#555;}
    input { width:100%; padding:10px; margin-bottom:18px; border-radius:5px; border:1px solid #ccc; font-size:14px;}
    button { width:100%; padding:12px; background-color:#4a90e2; color:white; font-size:16px; border:none; border-radius:6px; cursor:pointer;}
    button:hover { background-color:#357abd; }
    .message { margin-top:15px; text-align:center; font-weight:bold; display:none;}
    .error { color:red;}
    .success { color:green;}
    .footer { margin-top:25px; text-align:center; font-size:13px; color:darkblue;}
  </style>
</head>
<body>
<div class="container">
  <div class="title">BWC EXCHANGE SUBMISSION</div>

  <label>Officer ID</label>
  <input type="text" id="officerId" placeholder="PC, CPL, SGT or SSGT + ID">

  <label>BWC number</label>
  <input type="text" id="bwcNo" placeholder="3-digit or last 4-digit">

  <label>Battery (%)</label>
  <input type="number" id="battery" min="0" max="100" placeholder="0 - 100">

  <button onclick="submitData()">Submit</button>

  <div id="message" class="message"></div>
  <div class="footer">This application was created by Htet Aung Lynn.</div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxP_s8uYc72JyNJnQyZR8I2JbLCy6qRh82FoSfzDnogoTfs6J4yKSaQDkXqKGlqULY/exec";

function submitData() {
  const officerId = document.getElementById("officerId").value.trim();
  const bwcNo = document.getElementById("bwcNo").value.trim();
  const battery = document.getElementById("battery").value.trim();
  const messageBox = document.getElementById("message");
  messageBox.style.display = "none";

  if(!officerId || !bwcNo || !battery) { showMessage("Please fill all fields.","error"); return;}
  if(battery < 0 || battery > 100){ showMessage("Battery must be between 0 and 100.","error"); return;}

  fetch(WEB_APP_URL, {
    method:"POST",
    mode:"cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ officerId, bwcNo, battery })
  })
  .then(res => res.json())
  .then(data => {
      if(data.status === "duplicate") {
          showMessage("This ID has been already submitted.","error");
      } else if(data.status === "success") {
          showMessage("Successfully submitted.","success");
      } else {
          showMessage("Submission failed. Try again.","error");
      }

      // Clear all text boxes
      document.getElementById("officerId").value = "";
      document.getElementById("bwcNo").value = "";
      document.getElementById("battery").value = "";
  })
  .catch(() => {
      showMessage("Submission failed. Try again.","error");
      document.getElementById("officerId").value = "";
      document.getElementById("bwcNo").value = "";
      document.getElementById("battery").value = "";
  });
}

function showMessage(text,type){
  const box = document.getElementById("message");
  box.textContent=text;
  box.className="message "+type;
  box.style.display="block";
}
</script>
</body>
</html>
